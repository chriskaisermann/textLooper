!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.TextLooper=e()}(this,function(t){"use strict";function e(t){var e,n=-1,r=!1,a=!1,s=this;s.node=t;var i=function(){var t=["webkit","moz","MS","o",""];if(a)throw"TextLooper: Trying to initialize the instance more than once";if(a=!0,s.attrs=s.parseAttrs(),s.attrs.useComebackAsOut=!s.attrs.out&&s.node.hasAttribute(o.selector+"-comeback"),s.attrs.useComebackAsOut&&(_tmpAttrs.out=_tmpAttrs.in.slice(0)),s.attrs.useComebackAsOut){var e=".textlooper--reverse{";t.forEach(function(t,o){var n=t?"-":"";e+=n+t+n+"animation-direction: alternate-reverse;"}),e+="}",c(e)}t.forEach(function(t,e){s.node.addEventListener(t+(t.length?"AnimationEnd":"animationend"),l)})},l=function(){s.node.classList.remove("animated","textlooper--reverse",e),r=!r,s.attrs.out&&!r?u():setTimeout(u,s.attrs.delay[n])},u=function(){s.attrs.out&&r?(console.log("out"),e=s.attrs.out[n],s.attrs.useComebackAsOut&&s.node.classList.add("textlooper--reverse"),s.node.classList.add("animated",e)):(console.log("in"),++n===s.attrs.phrase.length&&(n=0),e=s.attrs.in[n],s.node.style.visibility="hidden",s.node.textContent=s.attrs.phrase[n],setTimeout(function(){s.node.style.visibility="visible",s.node.classList.add("animated",e)},0))},c=function(t){var e=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");e.querySelector("#textlooper-css")||(o.type="text/css",o.id="textlooper-css",o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t)),e.appendChild(o))},d=function(t){var e=[];return t.map(function(t){t=t.trim(),t.length&&e.push(t)}),e};this.start=function(){i(),this.node.classList.add("textlooper--looping"),u()},this.parseAttrs=function(){var t={phrase:[]};if(t.separator=s.node.getAttribute(o.selector+"-separator")||",",t.delay=s.node.getAttribute(o.selector),null==t.delay)throw"TextLooper: no "+o.selector+" attribute detected";if(t.delay=d(t.delay.split("|")),t.phrase=d(s.node.textContent.split(t.separator)),!t.phrase.length)throw"TextLooper: no text detected";return["in","out"].forEach(function(e){var n=o.selector+"-"+e;return s.node.hasAttribute(n)?(t[e]=s.node.getAttribute(n),void(t[e]=t[e]?d(t[e].split("|")):[])):void(t[e]=null)}),["in","out","delay"].forEach(function(e){if("out"!==e||t[e]){var n=t[e];if(n||(n=t[e]=[]),n.length<t.phrase.length){var r=n.length?n[0]:o[e];t[e]=t[e].concat(new Array(t.phrase.length-n.length).fill(r))}if(t[e].length!==t.phrase.length)throw"TextLooper: There are a different number of phrases and parameters"}}),t}}var o={delay:1500,in:"fadeIn",out:"fadeOut",selector:"data-textloop"};return e.getDefaults=function(){return o},e.setDefaultDelay=function(t){o.delay=t},e.setDefaultInAnimation=function(t){o.in=t},e.setDefaultOutAnimation=function(t){o.out=t},e.setSelector=function(t){o.selector=t},e.refresh=function(){for(var t=0,n=document.querySelectorAll("["+o.selector+"]:not(.textlooper--looping)");t<n.length;t++)new e(n[t]).start()},e});